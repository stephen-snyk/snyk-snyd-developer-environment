{"format_version":"1.1","terraform_version":"1.3.7","variables":{"bitbucket_password":{"value":"BBDC-ODYwMzc4NzcwNzE5Ouzb9Tk3m9vtTOcX6uCR2k3TGiOG"},"bitbucket_username":{"value":"stephen"},"gcp_project_id":{"value":"snyk-cx-se-demo"},"machine_type":{"value":"e2-standard-4"},"snyk_broker_token":{"value":"4a79127d-e690-4d2e-b1af-f2ff5ce869f5"},"zone1":{"value":"northamerica-northeast2-a"}},"planned_values":{"outputs":{"instance_name":{"sensitive":false},"public_ip1":{"sensitive":false}},"root_module":{"resources":[{"address":"google_compute_instance.origin1","mode":"managed","type":"google_compute_instance","name":"origin1","provider_name":"registry.terraform.io/hashicorp/google","schema_version":6,"values":{"advanced_machine_features":[],"allow_stopping_for_update":null,"attached_disk":[],"boot_disk":[{"auto_delete":true,"disk_encryption_key_raw":null,"initialize_params":[{"image":"https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/ubuntu-minimal-1804-bionic-v20230308"}],"mode":"READ_WRITE"}],"can_ip_forward":false,"deletion_protection":false,"description":null,"desired_status":null,"enable_display":null,"hostname":null,"labels":null,"machine_type":"e2-standard-4","metadata":{"snyk-terraform":"sperciballi-box"},"metadata_startup_script":"apt update -y \u0026\u0026 apt upgrade -y\napt install -y ca-certificates curl software-properties-common\n\n# Docker install\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nadd-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\"\napt update -y\napt install docker-ce -y\n\n#docker run  --name=\"bitbucket\" -d -p 7990:7990 -p 7999:7999 atlassian/bitbucket\n\ngit clone https://github.com/stephen-snyk/snyk-box.git\ncd snyk-box/bitbucket\ndocker build ./bitbucket/Dockerfile -t bitbucket:ssl\ndocker run --name=\"bitbucket\" -d -p 443:443 bitbucket:ssl\n\ndocker run -d --restart=always \\\n           -p 8000:8000 \\\n           -e BROKER_TOKEN=var.snyk_broker_token \\\n           -e BITBUCKET_USERNAME=var.bitbucket_username \\\n           -e BITBUCKET_PASSWORD=var.bitbucket_password \\\n           -e BITBUCKET=var.network_ip:443 \\\n           -e BITBUCKET_API=var.network_ip:443/rest/api/1.0 \\\n           -e PORT=8000 \\\n           -e BROKER_CLIENT_URL=http://localhost:8000 \\\n           -e ACCEPT_IAC=tf,yaml,yml,json,tpl \\\n           -e ACCEPT_CODE=true \\\n           -e NODE_TLS_REJECT_UNAUTHORIZED=0 \\\n       snyk/broker:bitbucket-server\nEOF\n","network_interface":[{"access_config":[{"public_ptr_domain_name":null}],"alias_ip_range":[],"ipv6_access_config":[],"network":"default","nic_type":null,"queue_count":null}],"resource_policies":null,"scratch_disk":[],"service_account":[],"shielded_instance_config":[],"tags":["https-server","sperciballi","ssh"],"timeouts":null,"zone":"northamerica-northeast2-a"},"sensitive_values":{"advanced_machine_features":[],"attached_disk":[],"boot_disk":[{"initialize_params":[{"labels":{}}]}],"confidential_instance_config":[],"guest_accelerator":[],"metadata":{},"network_interface":[{"access_config":[{}],"alias_ip_range":[],"ipv6_access_config":[]}],"reservation_affinity":[],"scheduling":[],"scratch_disk":[],"service_account":[],"shielded_instance_config":[],"tags":[false,false,false]}},{"address":"random_id.namespace1","mode":"managed","type":"random_id","name":"namespace1","provider_name":"registry.terraform.io/hashicorp/random","schema_version":0,"values":{"byte_length":2,"keepers":null,"prefix":"sperciballi-box-"},"sensitive_values":{}}],"child_modules":[{"resources":[{"address":"module.firewall_rules.google_compute_firewall.rules[\"sperciballi-box\"]","mode":"managed","type":"google_compute_firewall","name":"rules","index":"sperciballi-box","provider_name":"registry.terraform.io/hashicorp/google","schema_version":1,"values":{"allow":[{"ports":["22","80","8080","443","7990"],"protocol":"tcp"}],"deny":[],"description":null,"direction":"INGRESS","disabled":null,"log_config":[{"metadata":"INCLUDE_ALL_METADATA"}],"name":"sperciballi-box","network":"default","priority":1000,"project":"snyk-cx-se-demo","source_ranges":["69.165.159.114/32"],"source_service_accounts":null,"source_tags":null,"target_service_accounts":null,"target_tags":["sperciballi"],"timeouts":null},"sensitive_values":{"allow":[{"ports":[false,false,false,false,false]}],"deny":[],"destination_ranges":[],"log_config":[{}],"source_ranges":[false],"target_tags":[false]}}],"address":"module.firewall_rules"}]}},"resource_changes":[{"address":"google_compute_instance.origin1","mode":"managed","type":"google_compute_instance","name":"origin1","provider_name":"registry.terraform.io/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"advanced_machine_features":[],"allow_stopping_for_update":null,"attached_disk":[],"boot_disk":[{"auto_delete":true,"disk_encryption_key_raw":null,"initialize_params":[{"image":"https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/ubuntu-minimal-1804-bionic-v20230308"}],"mode":"READ_WRITE"}],"can_ip_forward":false,"deletion_protection":false,"description":null,"desired_status":null,"enable_display":null,"hostname":null,"labels":null,"machine_type":"e2-standard-4","metadata":{"snyk-terraform":"sperciballi-box"},"metadata_startup_script":"apt update -y \u0026\u0026 apt upgrade -y\napt install -y ca-certificates curl software-properties-common\n\n# Docker install\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nadd-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\"\napt update -y\napt install docker-ce -y\n\n#docker run  --name=\"bitbucket\" -d -p 7990:7990 -p 7999:7999 atlassian/bitbucket\n\ngit clone https://github.com/stephen-snyk/snyk-box.git\ncd snyk-box/bitbucket\ndocker build ./bitbucket/Dockerfile -t bitbucket:ssl\ndocker run --name=\"bitbucket\" -d -p 443:443 bitbucket:ssl\n\ndocker run -d --restart=always \\\n           -p 8000:8000 \\\n           -e BROKER_TOKEN=var.snyk_broker_token \\\n           -e BITBUCKET_USERNAME=var.bitbucket_username \\\n           -e BITBUCKET_PASSWORD=var.bitbucket_password \\\n           -e BITBUCKET=var.network_ip:443 \\\n           -e BITBUCKET_API=var.network_ip:443/rest/api/1.0 \\\n           -e PORT=8000 \\\n           -e BROKER_CLIENT_URL=http://localhost:8000 \\\n           -e ACCEPT_IAC=tf,yaml,yml,json,tpl \\\n           -e ACCEPT_CODE=true \\\n           -e NODE_TLS_REJECT_UNAUTHORIZED=0 \\\n       snyk/broker:bitbucket-server\nEOF\n","network_interface":[{"access_config":[{"public_ptr_domain_name":null}],"alias_ip_range":[],"ipv6_access_config":[],"network":"default","nic_type":null,"queue_count":null}],"resource_policies":null,"scratch_disk":[],"service_account":[],"shielded_instance_config":[],"tags":["https-server","sperciballi","ssh"],"timeouts":null,"zone":"northamerica-northeast2-a"},"after_unknown":{"advanced_machine_features":[],"attached_disk":[],"boot_disk":[{"device_name":true,"disk_encryption_key_sha256":true,"initialize_params":[{"labels":true,"size":true,"type":true}],"kms_key_self_link":true,"source":true}],"confidential_instance_config":true,"cpu_platform":true,"current_status":true,"guest_accelerator":true,"id":true,"instance_id":true,"label_fingerprint":true,"metadata":{},"metadata_fingerprint":true,"min_cpu_platform":true,"name":true,"network_interface":[{"access_config":[{"nat_ip":true,"network_tier":true}],"alias_ip_range":[],"ipv6_access_config":[],"ipv6_access_type":true,"name":true,"network_ip":true,"stack_type":true,"subnetwork":true,"subnetwork_project":true}],"project":true,"reservation_affinity":true,"scheduling":true,"scratch_disk":[],"self_link":true,"service_account":[],"shielded_instance_config":[],"tags":[false,false,false],"tags_fingerprint":true},"before_sensitive":false,"after_sensitive":{"advanced_machine_features":[],"attached_disk":[],"boot_disk":[{"disk_encryption_key_raw":true,"initialize_params":[{"labels":{}}]}],"confidential_instance_config":[],"guest_accelerator":[],"metadata":{},"network_interface":[{"access_config":[{}],"alias_ip_range":[],"ipv6_access_config":[]}],"reservation_affinity":[],"scheduling":[],"scratch_disk":[],"service_account":[],"shielded_instance_config":[],"tags":[false,false,false]}}},{"address":"module.firewall_rules.google_compute_firewall.rules[\"sperciballi-box\"]","module_address":"module.firewall_rules","mode":"managed","type":"google_compute_firewall","name":"rules","index":"sperciballi-box","provider_name":"registry.terraform.io/hashicorp/google","change":{"actions":["create"],"before":null,"after":{"allow":[{"ports":["22","80","8080","443","7990"],"protocol":"tcp"}],"deny":[],"description":null,"direction":"INGRESS","disabled":null,"log_config":[{"metadata":"INCLUDE_ALL_METADATA"}],"name":"sperciballi-box","network":"default","priority":1000,"project":"snyk-cx-se-demo","source_ranges":["69.165.159.114/32"],"source_service_accounts":null,"source_tags":null,"target_service_accounts":null,"target_tags":["sperciballi"],"timeouts":null},"after_unknown":{"allow":[{"ports":[false,false,false,false,false]}],"creation_timestamp":true,"deny":[],"destination_ranges":true,"enable_logging":true,"id":true,"log_config":[{}],"self_link":true,"source_ranges":[false],"target_tags":[false]},"before_sensitive":false,"after_sensitive":{"allow":[{"ports":[false,false,false,false,false]}],"deny":[],"destination_ranges":[],"log_config":[{}],"source_ranges":[false],"target_tags":[false]}}},{"address":"random_id.namespace1","mode":"managed","type":"random_id","name":"namespace1","provider_name":"registry.terraform.io/hashicorp/random","change":{"actions":["create"],"before":null,"after":{"byte_length":2,"keepers":null,"prefix":"sperciballi-box-"},"after_unknown":{"b64_std":true,"b64_url":true,"dec":true,"hex":true,"id":true},"before_sensitive":false,"after_sensitive":{}}}],"output_changes":{"instance_name":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"public_ip1":{"actions":["create"],"before":null,"after":{"access_config":[{"public_ptr_domain_name":null}],"alias_ip_range":[],"ipv6_access_config":[],"network":"default","nic_type":null,"queue_count":null},"after_unknown":{"access_config":[{"nat_ip":true,"network_tier":true}],"alias_ip_range":[],"ipv6_access_config":[],"ipv6_access_type":true,"name":true,"network_ip":true,"stack_type":true,"subnetwork":true,"subnetwork_project":true},"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.3.7","values":{"root_module":{"resources":[{"address":"data.google_compute_image.image","mode":"data","type":"google_compute_image","name":"image","provider_name":"registry.terraform.io/hashicorp/google","schema_version":0,"values":{"archive_size_bytes":2331484032,"creation_timestamp":"2023-03-08T00:58:05.286-08:00","description":"Canonical, Ubuntu, 18.04 LTS Minimal, amd64 bionic minimal image built on 2023-03-08, supports Shielded VM features","disk_size_gb":10,"family":"ubuntu-minimal-1804-lts","filter":null,"id":"projects/ubuntu-os-cloud/global/images/ubuntu-minimal-1804-bionic-v20230308","image_encryption_key_sha256":"","image_id":"3828825307266543859","label_fingerprint":"42WmSpB8rSM=","labels":{},"licenses":["https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/licenses/ubuntu-minimal-1804-lts"],"name":"ubuntu-minimal-1804-bionic-v20230308","project":"ubuntu-os-cloud","self_link":"https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/ubuntu-minimal-1804-bionic-v20230308","source_disk":"","source_disk_encryption_key_sha256":"","source_disk_id":"","source_image_id":"","status":"READY"},"sensitive_values":{"labels":{},"licenses":[false]}},{"address":"data.template_file.server","mode":"data","type":"template_file","name":"server","provider_name":"registry.terraform.io/hashicorp/template","schema_version":0,"values":{"filename":null,"id":"531be60c43c1401412470187509e3487ba6ca7b1120f41aaa30b446ab7a5cd52","rendered":"apt update -y \u0026\u0026 apt upgrade -y\napt install -y ca-certificates curl software-properties-common\n\n# Docker install\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nadd-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\"\napt update -y\napt install docker-ce -y\n\n#docker run  --name=\"bitbucket\" -d -p 7990:7990 -p 7999:7999 atlassian/bitbucket\n\ngit clone https://github.com/stephen-snyk/snyk-box.git\ncd snyk-box/bitbucket\ndocker build ./bitbucket/Dockerfile -t bitbucket:ssl\ndocker run --name=\"bitbucket\" -d -p 443:443 bitbucket:ssl\n\ndocker run -d --restart=always \\\n           -p 8000:8000 \\\n           -e BROKER_TOKEN=var.snyk_broker_token \\\n           -e BITBUCKET_USERNAME=var.bitbucket_username \\\n           -e BITBUCKET_PASSWORD=var.bitbucket_password \\\n           -e BITBUCKET=var.network_ip:443 \\\n           -e BITBUCKET_API=var.network_ip:443/rest/api/1.0 \\\n           -e PORT=8000 \\\n           -e BROKER_CLIENT_URL=http://localhost:8000 \\\n           -e ACCEPT_IAC=tf,yaml,yml,json,tpl \\\n           -e ACCEPT_CODE=true \\\n           -e NODE_TLS_REJECT_UNAUTHORIZED=0 \\\n       snyk/broker:bitbucket-server\nEOF\n","template":"apt update -y \u0026\u0026 apt upgrade -y\napt install -y ca-certificates curl software-properties-common\n\n# Docker install\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nadd-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\"\napt update -y\napt install docker-ce -y\n\n#docker run  --name=\"bitbucket\" -d -p 7990:7990 -p 7999:7999 atlassian/bitbucket\n\ngit clone https://github.com/stephen-snyk/snyk-box.git\ncd snyk-box/bitbucket\ndocker build ./bitbucket/Dockerfile -t bitbucket:ssl\ndocker run --name=\"bitbucket\" -d -p 443:443 bitbucket:ssl\n\ndocker run -d --restart=always \\\n           -p 8000:8000 \\\n           -e BROKER_TOKEN=var.snyk_broker_token \\\n           -e BITBUCKET_USERNAME=var.bitbucket_username \\\n           -e BITBUCKET_PASSWORD=var.bitbucket_password \\\n           -e BITBUCKET=var.network_ip:443 \\\n           -e BITBUCKET_API=var.network_ip:443/rest/api/1.0 \\\n           -e PORT=8000 \\\n           -e BROKER_CLIENT_URL=http://localhost:8000 \\\n           -e ACCEPT_IAC=tf,yaml,yml,json,tpl \\\n           -e ACCEPT_CODE=true \\\n           -e NODE_TLS_REJECT_UNAUTHORIZED=0 \\\n       snyk/broker:bitbucket-server\nEOF\n","vars":null},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"google":{"name":"google","full_name":"registry.terraform.io/hashicorp/google","expressions":{"project":{"references":["var.gcp_project_id"]}}},"random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random"},"template":{"name":"template","full_name":"registry.terraform.io/hashicorp/template"}},"root_module":{"outputs":{"instance_name":{"expression":{"references":["random_id.namespace1.hex","random_id.namespace1"]}},"public_ip1":{"expression":{"references":["google_compute_instance.origin1.network_interface[0]","google_compute_instance.origin1.network_interface","google_compute_instance.origin1"]}}},"resources":[{"address":"google_compute_instance.origin1","mode":"managed","type":"google_compute_instance","name":"origin1","provider_config_key":"google","expressions":{"boot_disk":[{"initialize_params":[{"image":{"references":["data.google_compute_image.image.self_link","data.google_compute_image.image"]}}]}],"machine_type":{"references":["var.machine_type"]},"metadata":{"constant_value":{"snyk-terraform":"sperciballi-box"}},"metadata_startup_script":{"references":["data.template_file.server.rendered","data.template_file.server"]},"name":{"references":["random_id.namespace1.hex","random_id.namespace1"]},"network_interface":[{"access_config":[{}],"network":{"constant_value":"default"}}],"tags":{"constant_value":["sperciballi","ssh","https-server"]},"zone":{"references":["var.zone1"]}},"schema_version":6},{"address":"random_id.namespace1","mode":"managed","type":"random_id","name":"namespace1","provider_config_key":"random","expressions":{"byte_length":{"constant_value":2},"prefix":{"constant_value":"sperciballi-box-"}},"schema_version":0},{"address":"data.google_compute_image.image","mode":"data","type":"google_compute_image","name":"image","provider_config_key":"google","expressions":{"family":{"constant_value":"ubuntu-minimal-1804-lts"},"project":{"constant_value":"ubuntu-os-cloud"}},"schema_version":0},{"address":"data.template_file.server","mode":"data","type":"template_file","name":"server","provider_config_key":"template","expressions":{"template":{"references":["path.module"]}},"schema_version":0}],"module_calls":{"firewall_rules":{"source":"terraform-google-modules/network/google//modules/firewall-rules","expressions":{"network_name":{"constant_value":"default"},"project_id":{"references":["var.gcp_project_id"]},"rules":{"constant_value":[{"allow":[{"ports":[22,80,8080,443,7990],"protocol":"tcp"}],"deny":[],"description":null,"direction":"INGRESS","log_config":{"metadata":"INCLUDE_ALL_METADATA"},"name":"sperciballi-box","priority":null,"ranges":["69.165.159.114/32"],"source_service_accounts":null,"source_tags":null,"target_service_accounts":null,"target_tags":["sperciballi"]}]}},"module":{"outputs":{"firewall_rules":{"expression":{"references":["google_compute_firewall.rules"]},"description":"The created firewall rule resources"}},"resources":[{"address":"google_compute_firewall.rules","mode":"managed","type":"google_compute_firewall","name":"rules","provider_config_key":"google","expressions":{"description":{"references":["each.value.description","each.value"]},"destination_ranges":{"references":["each.value.direction","each.value","each.value.ranges","each.value"]},"direction":{"references":["each.value.direction","each.value"]},"name":{"references":["each.value.name","each.value"]},"network":{"references":["var.network_name"]},"priority":{"references":["each.value.priority","each.value"]},"project":{"references":["var.project_id"]},"source_ranges":{"references":["each.value.direction","each.value","each.value.ranges","each.value"]},"source_service_accounts":{"references":["each.value.source_service_accounts","each.value"]},"source_tags":{"references":["each.value.source_tags","each.value"]},"target_service_accounts":{"references":["each.value.target_service_accounts","each.value"]},"target_tags":{"references":["each.value.target_tags","each.value"]}},"schema_version":1,"for_each_expression":{"references":["var.rules"]}}],"variables":{"network_name":{"description":"Name of the network this set of firewall rules applies to."},"project_id":{"description":"Project id of the project that holds the network."},"rules":{"default":[],"description":"List of custom rule definitions (refer to variables file for syntax)."}}}}},"variables":{"bitbucket_password":{"description":"Bitbucket password"},"bitbucket_username":{"description":"Bitbucket username"},"gcp_project_id":{"description":"Google Cloud Platform (GCP) Project ID."},"machine_type":{"description":"GCP VM instance machine type."},"snyk_broker_token":{"description":"Snyk Broker Token"},"zone1":{"description":"GCP zone name."}}}},"relevant_attributes":[{"resource":"random_id.namespace1","attribute":["hex"]},{"resource":"data.template_file.server","attribute":["rendered"]},{"resource":"data.google_compute_image.image","attribute":["self_link"]},{"resource":"module.firewall_rules.google_compute_firewall.rules","attribute":[]},{"resource":"google_compute_instance.origin1","attribute":["network_interface",0]}]}
